# 项目规则文件（AGENTS.md）

本文件用于约束助手在本仓库中的所有后续行为。后续开发、改动、重构、接口设计均以本文件为准。

## 1. 全局规则（最高优先级）
- 主控端与 Pad 端必须严格分离：主控端用于管理者；Pad 端用于老师和学生。
- 角色权限必须清晰隔离：管理者、老师、学生只能看到并操作各自权限内的功能。
- 后端与 AI 服务职责必须分离：Spring Boot 负责业务与数据；FastAPI 负责 AI 能力（RAG、成绩预测等）AI端用uv来控制虚拟环境。
- 禁止将业务定制代码写进若依主体框架核心模块，业务代码放在项目业务模块中维护。

## 2. 业务范围与角色能力
- 管理者（主界面）：
  - 查看所有班级成绩（全局视角）。
  - 创建学生作业任务与老师任务。
  - 通过主界面中的 Pad 端入口进入老师/学生业务入口。
- 老师（Pad 端）：
  - 登录/注册后可布置作业、布置考试、查看学生成绩。
  - 可使用 AI 智能助手能力（如 RAG、成绩预测）。
- 学生（Pad 端）：
  - 登录/注册后可查看自己的作业、完成/提交作业、查看自己的考试成绩。
  - 可使用 AI 智能助手能力（如 RAG、成绩预测）。

## 3. 前端结构规则
- 主控端功能保持在主管理界面，不与 Pad 端页面混杂。
- 老师和学生相关页面统一放在 `frontend/src/views/education` 及其对应子模块下。
- Pad 端入口必须从主界面可达，但进入后按老师/学生权限展示不同页面与操作。
- 路由集中管理，禁止在页面内散落临时路由定义。

## 4. 接口与路由统一规则
- 前端所有接口调用必须统一写在 `frontend/src/api` 对应模块文件中，禁止在 `views` 组件内直接手写请求。
- 前端路由统一在 `frontend/src/router` 中维护，禁止分散定义导致权限与导航不一致。
- 新增功能时必须同时补齐：
  - 对应 API 模块定义
  - 对应路由配置
  - 对应权限控制（按管理者/老师/学生）

## 5. 后端与 AI 服务边界
- Spring Boot（backend）：
  - 负责用户、角色、作业、考试、成绩、任务等核心业务逻辑与数据持久化。
  - 负责权限鉴权与业务流程编排。
- FastAPI（ai_service）：
  - 仅负责 AI 能力：RAG 检索问答、成绩预测及相关模型服务。
  - 不承载主业务权限与核心业务流程。
- 后端通过清晰接口调用 AI 服务，避免职责重叠和代码耦合。

## 6. 开发与实现约束
- 新需求优先判断属于主控端还是 Pad 端，禁止跨端乱放功能。
- 老师/学生功能默认放到 education 相关目录和模块。
- 所有跨角色页面都必须显式做权限校验与数据隔离（学生只能看到自己的数据）。
- 代码实现优先复用现有目录结构与模块风格，避免重复造轮子。

## 7. 禁止项（硬性）
- 禁止把 AI 推理逻辑直接写入 Spring Boot 主业务服务中。
- 禁止把业务定制代码直接改进若依主体框架核心公共代码（ruoyi 核心模块）。
- 禁止前端在页面组件内直接散写接口地址和请求逻辑。
- 禁止主控端与 Pad 端页面、路由、权限混用。

## 8. 沟通与输出偏好
- 默认使用中文沟通。
- 输出风格：简洁、可执行、直接落地。
- 修改代码时优先给出受影响模块与改动点，不做空泛描述。

## 9. 冲突处理
- 当规则冲突时，按以下优先级执行：
  1. 本文件第 1 节（全局规则）
  2. 本文件第 7 节（禁止项）
  3. 本文件其他章节
  4. 仓库内其他文档约定

## 10. 生效说明
- 本文件一经更新，后续任务按最新版执行。
- 若用户临时需求与本文件冲突，先明确冲突点，再由用户确认后执行。
